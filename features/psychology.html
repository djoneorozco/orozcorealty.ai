<!DOCTYPE html><!--  This site was created in Webflow. https://webflow.com  --><!--  Last Published: Wed Oct 29 2025 06:47:48 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="68f067ce3b1e014c2558c550" data-wf-site="68cecb820ec3dbdca3ef9099" lang="en">
<head>
  <meta charset="utf-8">
  <title>Psychology</title>
  <meta content="Psychology" property="og:title">
  <meta content="Psychology" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="../css/normalize.css" rel="stylesheet" type="text/css">
  <link href="../css/webflow.css" rel="stylesheet" type="text/css">
  <link href="../css/new-real-estate-purchase.webflow.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Droid Serif:400,400italic,700,700italic","PT Serif:400,400italic,700,700italic","Bitter:400,700,400italic","Vollkorn:400,400italic,700,700italic","Varela:400","Lato:100,100italic,300,300italic,400,400italic,700,700italic,900,900italic","Great Vibes:400","Merriweather:300,300italic,400,400italic,700,700italic,900,900italic","DM Sans:300,regular,500,600,700","Gilda Display:regular","Barlow Condensed:regular","Barlow:300italic,regular,italic,500","Material Icons Outlined:regular","Material Icons:regular"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="../images/favicon.svg" rel="shortcut icon" type="image/x-icon">
  <link href="../images/webclip.jpg" rel="apple-touch-icon">
</head>
<body class="body-8">
  <section>
    <section>
      <div class="code-embed-12 w-embed w-script"><!--  A.I.O.U • Timed Buyer Psychology Test (visual Q1 + header overall timer + top-edge question progress)  -->
        <div id="aiou-shell" data-endpoint="https://theorozcorealty.netlify.app/.netlify/functions/aiou-report" style="all: initial;">
          <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
          <style>
    #aiou-shell, #aiou-shell *{ box-sizing:border-box; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }
    :root{
      --bg:#0b0e1a; --panel:#101426; --panel-2:#0f1324;
      --ink:#e9ecff; --muted:#a8b0d6; --border:rgba(255,255,255,.10);
      --accent:#8ef3c5; --accent2:#6aa7ff; --danger:#ff8aa6;
    }
    #aiou-portal{ position:fixed; inset:0; z-index:2147483647; background:var(--bg); color:var(--ink); overflow-y:auto; isolation:isolate; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
    .wrap{ max-width:min(100vw - 48px,1080px); margin:28px auto 90px; padding:0 16px; }
    .card{ background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02)); border:1px solid var(--border); border-radius:18px; padding:18px 18px 16px; margin:16px 0; box-shadow:0 14px 48px rgba(0,0,0,.55); position:relative; }
    h1.title{ font-weight:900; font-size:26px; margin:0 0 8px; letter-spacing:.2px; }
    h2{ font-weight:800; font-size:16px; margin:0 0 10px; }
    .sub{ color:var(--muted); font-size:13px; margin:0 0 8px; }
    .grid{ display:grid; grid-template-columns:1fr 1fr; gap:14px; } @media(max-width:900px){ .grid{ grid-template-columns:1fr; } }
    label{ font-size:12px; display:block; margin:0 0 6px; color:var(--ink); font-weight:600; }
    input, select{ width:100%; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.14); background:rgba(255,255,255,.06); color:var(--ink); }
    input::placeholder{ color:#c9d2ff88; }
    .bar{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; }
    .btn{ border:1px solid rgba(255,255,255,.14); background:var(--panel-2); color:var(--ink); padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:800; }
    .btn.primary{ background:linear-gradient(180deg,var(--accent2),#4f86ff); border:none; color:#06112b; }
    .btn.ghost{ background:transparent; }
    .btn.warn{ background:transparent; border-color:var(--danger); color:var(--danger); }
    /* Question scale pills */
    .scale{ display:grid; grid-template-columns:repeat(11,1fr); gap:8px; margin:12px 0 0; }
    .pill{ text-align:center; padding:8px 0; border-radius:10px; font-size:12px; border:1px solid rgba(255,255,255,.16); background:rgba(255,255,255,.06); cursor:pointer; }
    .pill[data-sel="1"]{ outline:2px solid var(--accent2); color:#06112b; background:linear-gradient(180deg,var(--accent2),#4f86ff); border:none; }
    /* Old per-question timer moved to TOP EDGE */
    .qtopbar{ position:absolute; left:12px; right:12px; top:8px; height:6px; background:rgba(255,255,255,.10); border-radius:999px; overflow:hidden; }
    .qtopbar>i{ display:block; height:100%; width:100%; background:linear-gradient(90deg,var(--accent),var(--accent2)); transform-origin:left; }
    /* Overall header timer (right side of title card) */
    .overallTimer{ position:absolute; right:18px; top:18px; display:flex; align-items:center; gap:10px; }
    .overallTimer .badge{ font-size:11px; color:#06112b; background:linear-gradient(180deg,var(--accent2),#4f86ff); padding:4px 8px; border-radius:999px; font-weight:900; border:none; }
    .overallTimer .hint{ color:#a8b0d6; font-size:12px; }
    .kpis{ display:grid; grid-template-columns:repeat(5,1fr); gap:10px; margin-top:10px; }
    .kp{ background:rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.12); border-radius:12px; padding:12px; text-align:center; }
    .kp h3{ margin:0 0 6px; font-size:12px; color:var(--muted); }
    .kp div{ font-size:18px; font-weight:900; color:var(--ink); }
    pre{ white-space:pre-wrap; background:rgba(255,255,255,.05); padding:12px; border-radius:12px; border:1px solid rgba(255,255,255,.12); font-size:12px; color:var(--ink); }
    .note{ font-size:12px; color:var(--muted); margin-top:6px; }
    .flag{ color:var(--danger); font-weight:800; } .ok{ color:#58f7b7; font-weight:800; }
    /* Visual Q1: images side-by-side, slider below */
    .dualpref{ display:grid; grid-template-columns:1fr 1fr; grid-template-rows:auto auto; gap:12px; align-items:center; margin-top:10px; }
    .dualpref figure{ margin:0 }
    .dualpref img{ width:100%; border-radius:12px; border:1px solid var(--border); object-fit:cover; object-position:center; max-height:280px; background:#0b0e1a; }
    .dualpref .sliderRow{ grid-column:1 / -1; display:flex; align-items:center; gap:12px; }
    .sliderRow .end{ flex:0 0 auto; font-size:12px; color:var(--muted); font-weight:700; }
    .sliderRow .rangeWrap{ flex:1 1 auto; display:flex; align-items:center; gap:8px; }
    .rangeWrap input[type=range]{ width:100%; }
    input[type=range]{ -webkit-appearance:none; appearance:none; height:4px; background:rgba(255,255,255,.18); border-radius:999px; }
    input[type=range]::-webkit-slider-thumb{ -webkit-appearance:none; width:18px; height:18px; border-radius:50%; background:var(--accent2); border:0; }
    input[type=range]::-moz-range-thumb{ width:18px; height:18px; border-radius:50%; background:var(--accent2); border:0; }
    input[type=range]::-webkit-slider-runnable-track{ height:4px; border-radius:999px; }
  </style>
          <script>
  (function(){
    if (window.__AIOU_MOUNTED__) return; window.__AIOU_MOUNTED__=true;
    const portal=document.createElement('div'); portal.id='aiou-portal'; document.body.appendChild(portal);
    portal.innerHTML = `
      <div class="wrap">
        <div class="card">
          <h1 class="title">A.I.O.U • Timed Buyer Psychology Test</h1>
          <div class="overallTimer">
            <span class="hint">About <span id="overallHint">~3 min</span></span>
            <span class="badge" id="overallClock">3:00</span>
          </div>
          <p class="sub">Each question is timed (<b>10 seconds</b>). Choose from <b>-5</b> to <b>+5</b>. Some items repeat in different words to check consistency.</p>
          <div class="bar">
            <button class="btn primary" id="startQuiz">Start Timed Quiz</button>
            <button class="btn ghost" id="closePortal">Close</button>
          </div>
        </div>
        <div class="card" id="profile">
          <h2>Profile & Goals</h2>
          <div class="grid">
            <div><label>First Name</label><input id="firstName" type="text" placeholder="e.g., Alex"></div>
            <div><label>Last Name</label><input id="lastName" type="text" placeholder="e.g., Rivera"></div>
            <div><label>Bedrooms wanted</label><input id="bedrooms" type="number" min="0" step="1" placeholder="e.g., 4"></div>
            <div><label>Budget (max $)</label><input id="budget" type="number" min="0" step="1000" placeholder="e.g., 450000"></div>
            <div><label>Preferred setting</label>
              <select id="setting"><option value="city">City</option><option value="suburb">Suburb</option><option value="rural">Rural</option></select>
            </div>
            <div><label>Safety priority (1–5)</label>
              <select id="safety"><option>1</option><option>2</option><option>3</option><option>4</option><option selected>5</option></select>
            </div>
          </div>
        </div>
        <div class="card" id="quiz" style="display:none; position:relative;">
          <!-- Per-question progress now lives at the TOP EDGE -->
          <div class="qtopbar"><i id="qTopTimer"></i></div>
          <h2 id="qTitle" style="margin-top:10px;">Question</h2>
          <div id="qText" class="sub"></div>
          <!-- Visual area (Q1 only) -->
          <div id="visualArea" style="display:none;">
            <div class="dualpref">
              <figure>
                <img id="vImgA" src="https://cdn.prod.website-files.com/68cecb820ec3dbdca3ef9099/68f9a10aab47946a36f5c135_04d878cc02583fb9bfda33ddbd28d91a_MinorFixesHome.jpg" alt="May Require Fixes (Option A)">
                <figcaption class="sub" style="text-align:center;margin-top:6px;">May Require Fixes</figcaption>
              </figure>
              <figure>
                <img id="vImgB" src="https://cdn.prod.website-files.com/68cecb820ec3dbdca3ef9099/68f9a113c4924ecebad2319a_a0cc3184b96f525ed5a278c3bac62891_BrandNewHome.jpg" alt="Brand New Home (Option B)">
                <figcaption class="sub" style="text-align:center;margin-top:6px;">Brand New Home</figcaption>
              </figure>
              <div class="sliderRow">
                <span class="end">Needs Fixes</span>
                <div class="rangeWrap"><input id="vSlider" type="range" min="-5" max="5" value="0" step="1" aria-label="Preference between Needs Fixes and Brand New"></div>
                <span class="end">Brand New</span>
              </div>
            </div>
            <div class="note" id="vLabel" style="margin-top:6px; text-align:center;">Neutral</div>
          </div>
          <!-- Standard scale (hidden for visual question) -->
          <div class="scale" id="scale"></div>
          <div class="bar"><button class="btn ghost" id="skip">Skip</button><button class="btn warn" id="reset">Reset</button></div>
          <div class="note">No answer = neutral (0) after 10s. Skip to move on immediately.</div>
        </div>
        <div class="card" id="results" style="display:none;">
          <h2>Results</h2>
          <div class="kpis">
            <div class="kp"><h3>Openness</h3><div id="kO">—</div></div>
            <div class="kp"><h3>Conscientiousness</h3><div id="kC">—</div></div>
            <div class="kp"><h3>Extraversion</h3><div id="kE">—</div></div>
            <div class="kp"><h3>Agreeableness</h3><div id="kA">—</div></div>
            <div class="kp"><h3>Risk Aversion</h3><div id="kN">—</div></div>
          </div>
          <div id="consistency" class="note" style="margin-top:8px;"></div>
          <div id="archetype" style="margin:10px 0;font-weight:900;"></div>
          <div id="mbti" style="margin:4px 0 2px;font-weight:800;"></div>
          <pre id="json"></pre>
          <div class="bar">
            <button class="btn primary" id="btnReport">Generate Report (OpenAI)</button>
            <button class="btn" id="btnCopy">Copy JSON</button>
          </div>
          <div id="llmOut" style="margin-top:10px;"></div>
        </div>
      </div>
    `;
    const $=(s)=>portal.querySelector(s); const $$=(s)=>Array.from(portal.querySelectorAll(s));
    /* ===== Questions (Q1 is visual slider) ===== */
    const Q = [
      { id:'V1', type:'visual', dim:'O', text:'Choose between Brand New Home vs May Require Fixes.', rev:false },
      { id:'O1',  dim:'O', text:'I prefer a home that looks new or freshly renovated rather than plain but practical.', rev:false, ctrlPair:'O1b' },
      { id:'O1b', dim:'O', text:'I’m fine with a simple, ordinary-looking home if it works.',                         rev:true,  ctrlPair:'O1'  },
      { id:'O2',  dim:'O', text:'Special features (big windows, open kitchen, modern finishes) are worth paying more.', rev:false },
      { id:'O3',  dim:'O', text:'I want a home that feels different from most homes I’ve seen.',                        rev:false },
      { id:'C1',  dim:'C', text:'If a place is just above my budget, I would still try to get it.', rev:true,  ctrlPair:'C1b' },
      { id:'C1b', dim:'C', text:'I will not go over my budget, even if I love the home.',          rev:false, ctrlPair:'C1'  },
      { id:'C2',  dim:'C', text:'Lower monthly costs matter more to me than extra style.',          rev:false },
      { id:'E1',  dim:'E', text:'I often picture hosting dinners, parties, or family gatherings at home.', rev:false, ctrlPair:'E1b' },
      { id:'E1b', dim:'E', text:'I rarely imagine hosting people at my home.',                             rev:true,  ctrlPair:'E1'  },
      { id:'E2',  dim:'E', text:'I would trade an extra bedroom for a bigger living room or outdoor area.', rev:false },
      { id:'A1',  dim:'A', text:'I can be flexible on details if the main things are met.', rev:false, ctrlPair:'A1b' },
      { id:'A1b', dim:'A', text:'Once I set my must-haves, I won’t bend on them.',          rev:true,  ctrlPair:'A1'  },
      { id:'N1',  dim:'N', text:'Buying a home that needs repairs would stress me out.',         rev:false, ctrlPair:'N1b' },
      { id:'N1b', dim:'N', text:'A home that needs repairs doesn’t worry me much.',              rev:true,  ctrlPair:'N1'  },
      { id:'N2',  dim:'N', text:'I’d rather choose a 5–10 year-old home that’s already proven than brand-new.', rev:false },
      { id:'N3',  dim:'N', text:'I prefer a quieter, safer area even if it’s farther from restaurants and events.', rev:false },
      { id:'X1',  dim:'O', text:'If I must choose, I’ll pick style and layout over getting the lowest possible price.', rev:false }
    ];
    const answers={}; let idx=0, timer=null, tLeft=10;
    let overallTimer=null, overallLeftMs = Q.length * 10000; // 10s each
    function mmss(ms){ const s=Math.max(0, Math.ceil(ms/1000)); const m=Math.floor(s/60), r=s%60; return `${m}:${String(r).padStart(2,'0')}`; }
    function buildScale(){
      const s=$('#scale'); s.innerHTML='';
      for(let v=-5; v<=5; v++){
        const b=document.createElement('div');
        b.className='pill'; b.textContent=String(v); b.dataset.val=v;
        b.addEventListener('click',()=>selectValue(v));
        s.appendChild(b);
      }
    }
    function start(){
      $('#quiz').style.display='block'; $('#results').style.display='none';
      idx=0; Q.forEach(q=> answers[q.id]=undefined);
      overallLeftMs = Q.length * 10000;
      $('#overallClock').textContent = mmss(overallLeftMs);
      if (overallTimer) clearInterval(overallTimer);
      overallTimer = setInterval(()=>{
        overallLeftMs -= 200;
        if (overallLeftMs <= 0) { overallLeftMs = 0; clearInterval(overallTimer); }
        $('#overallClock').textContent = mmss(overallLeftMs);
      },200);
      renderQ();
    }
    function renderQ(){
      const q=Q[idx];
      $('#qTitle').textContent=`Question ${idx+1} / ${Q.length}`;
      $('#qText').textContent=q.type==='visual' ? 'Where are you between these two options right now?' : q.text;
      const visual = $('#visualArea');
      const scale  = $('#scale');
      if(q.type==='visual'){
        visual.style.display='block';
        scale.style.display='none';
        initVisualSlider();
      }else{
        visual.style.display='none';
        scale.style.display='grid';
        buildScale();
        $$('.pill').forEach(p=>p.dataset.sel='0');
        const prev=answers[q.id];
        if(prev!==undefined && prev!==null){
          const el=$$('.pill').find(x=>Number(x.dataset.val)===prev);
          if(el) el.dataset.sel='1';
        }
      }
      startTimer();
    }
    function startTimer(){
      clearInterval(timer); tLeft=10;
      const bar=$('#qTopTimer'); // NEW: top-edge bar
      if (bar) bar.style.transform='scaleX(1)';
      timer=setInterval(()=>{
        tLeft-=0.05;
        const frac=Math.max(0,tLeft/10);
        if (bar) bar.style.transform=`scaleX(${frac})`;
        if(tLeft<=0){ clearInterval(timer); record(null); }
      },50);
    }
    function selectValue(v){ clearInterval(timer); record(v); }
    function record(v){
      const q=Q[idx];
      if(q.type==='visual'){
        const s = $('#vSlider');
        const val = (v===null ? 0 : Number(s.value||0));
        answers[q.id] = val;
        window.__STYLE_V_PRICE = val;
      }else{
        answers[q.id] = (v===null ? 0 : Number(v));
      }
      idx++; (idx<Q.length)?renderQ():finish();
    }
    /* ---------- Visual slider setup (Q1) ---------- */
    function initVisualSlider(){
      const s=$('#vSlider'), label=$('#vLabel'), imgA=$('#vImgA'), imgB=$('#vImgB');
      function explain(v){
        if (v <= -3) return "Prefers Needs Fixes strongly (Option A)";
        if (v === -2 || v === -1) return "Leans Needs Fixes (Option A)";
        if (v === 0) return "Neutral";
        if (v === 1 || v === 2) return "Leans Brand New (Option B)";
        return "Prefers Brand New strongly (Option B)";
      }
      function update(){ const v=Number(s.value||0); window.__STYLE_V_PRICE=v; if(label) label.textContent=explain(v); s.setAttribute('aria-valuetext', label.textContent); }
      if (s){
        if (window.__STYLE_V_PRICE==null) s.value="0";
        s.removeEventListener('input', s.__onInput || (()=>{}));
        s.__onInput = ()=>update();
        s.addEventListener('input', s.__onInput);
        update();
      }
      imgA && imgA.addEventListener('click', ()=>{ s.value = Math.max(-5,(Number(s.value)||0)-1); s.dispatchEvent(new Event('input')); });
      imgB && imgB.addEventListener('click', ()=>{ s.value = Math.min( 5,(Number(s.value)||0)+1); s.dispatchEvent(new Event('input')); });
    }
    function score(){
      const dims={O:[],C:[],E:[],A:[],N:[]};
      Q.forEach(q=>{
        if(q.type==='visual') return;
        let v=answers[q.id]; if(v===undefined || v===null) v=0; if(q.rev) v=-v;
        const m=((v+5)*0.4)+1; if(dims[q.dim]) dims[q.dim].push(m);
      });
      const avg=a=>a.reduce((x,y)=>x+y,0)/a.length || 3;
      const S={ O:+avg(dims.O).toFixed(2), C:+avg(dims.C).toFixed(2), E:+avg(dims.E).toFixed(2), A:+avg(dims.A).toFixed(2), N:+avg(dims.N).toFixed(2) };
      const v = Number(window.__STYLE_V_PRICE || 0); // gentle nudge to Openness
      S.O = +(Math.max(1, Math.min(5, S.O + (v/12.5)))).toFixed(2);
      const flags=[]; const map=Object.fromEntries(Q.map(q=>[q.id,q])); const handled=new Set();
      Q.forEach(q=>{
        if(q.ctrlPair && !handled.has(q.id)){
          const a=answers[q.id]; const b=answers[q.ctrlPair];
          if(a!=null && b!=null){
            const aAdj=q.rev? -a:a, bAdj=(map[q.ctrlPair].rev? -b:b);
            if(Math.abs(aAdj-bAdj)>=6) flags.push(`${q.id}/${q.ctrlPair}`);
          }
          handled.add(q.id); handled.add(q.ctrlPair);
        }
      });
      return {scores:S, inconsistencies:flags};
    }
    const MBTI_BUYER_GUIDE = {
      ISTJ:"Stable, detail-first. Prefers proven neighborhoods, low-variance costs, and strong inspection records.",
      ISFJ:"Practical caretaker. Values safety, schools, and quiet streets; favors move-in-ready over projects.",
      INFJ:"Purpose-driven. Wants harmony and meaningful space; calm areas and quality renovations matter.",
      INTJ:"Planner/optimizer. Seeks value efficiency and long-term upside; ignores fluffy upgrades.",
      ISTP:"Hands-on problem-solver. Open to light projects if priced right; needs clear scope/timeline.",
      ISFP:"Aesthetic + comfort. Drawn to warm finishes, natural light, and cozy outdoor spots.",
      INFP:"Idealistic. Wants character and story; needs guardrails so budget doesn’t drift.",
      INTP:"Analytical. Structure/systems/future flexibility > staging glam.",
      ESTP:"Action-oriented. Loves lively areas and entertainment spaces; avoid payment creep.",
      ESFP:"Experience-first. Open layouts and social hubs; size payment first, then pick the fun.",
      ENFP:"Vision + people. Creative layouts, natural light; watch impulsive upgrades.",
      ENTP:"Options hunter. Wants flexibility/ADU potential; negotiate hard.",
      ESTJ:"Structured operator. Predictability, commute efficiency, and low-maintenance wins.",
      ESFJ:"Community anchor. Schools/parks close; turnkey > fixer to keep harmony.",
      ENFJ:"Connector. Hosting flow matters; choose move-in-ready to keep momentum.",
      ENTJ:"Decisive strategist. Location + resale math; newish or quality reno to avoid downtime.",
    };
    function mbtiLabel(type){
      const map={ ISTJ:"Inspector", ISFJ:"Protector", INFJ:"Sage", INTJ:"Architect", ISTP:"Crafter", ISFP:"Artist", INFP:"Idealist", INTP:"Analyst", ESTP:"Promoter", ESFP:"Performer", ENFP:"Champion", ENTP:"Debater", ESTJ:"Executive", ESFJ:"Consul", ENFJ:"Protagonist", ENTJ:"Commander" };
      return map[type] || "Persona";
    }
    function letterEI(E){ return E>=3.75 ? 'E' : (E<=3.25 ? 'I' : (E>=3.5?'E':'I')); }
    function letterSN(O){ return O>=3.75 ? 'N' : (O<=3.25 ? 'S' : (O>=3.5?'N':'S')); }
    function letterTF(A){ return A>=3.75 ? 'F' : (A<=3.25 ? 'T' : (A>=3.5?'F':'T')); }
    function letterJP(C){ return C>=3.75 ? 'J' : (C<=3.25 ? 'P' : (C>=3.5?'J':'P')); }
    function scoresToMBTI(S){
      const ei=letterEI(S.E), sn=letterSN(S.O), tf=letterTF(S.A), jp=letterJP(S.C);
      const type=`${ei}${sn}${tf}${jp}`;
      const dist=(v,hi=true)=> hi? Math.max(0,v-3.5)/1.5 : Math.max(0,3.5-v)/1.5;
      const parts=[ ei==='E'?dist(S.E,true):dist(S.E,false), sn==='N'?dist(S.O,true):dist(S.O,false), tf==='F'?dist(S.A,true):dist(S.A,false), jp==='J'?dist(S.C,true):dist(S.C,false) ];
      const confidence=Math.max(0.35, +(parts.reduce((a,b)=>a+b,0)/4).toFixed(2));
      return { type, confidence };
    }
    function finish(){
      $('#quiz').style.display='none';
      if (overallTimer) clearInterval(overallTimer);
      const {scores,inconsistencies}=score();
      $('#kO').textContent=scores.O.toFixed(2);
      $('#kC').textContent=scores.C.toFixed(2);
      $('#kE').textContent=scores.E.toFixed(2);
      $('#kA').textContent=scores.A.toFixed(2);
      $('#kN').textContent=scores.N.toFixed(2);
      const arch = (function(s){ const hi=v=>v>=4.0, lo=v=>v<=2.5; if(hi(s.O)&&hi(s.E)) return 'Visionary Host'; if(hi(s.C)&&!hi(s.O)&&!hi(s.E)) return 'Steady Planner'; if(hi(s.N)&&lo(s.E)) return 'Risk-Guarded Nest-Builder'; if(hi(s.A)&&hi(s.C)) return 'Family-First Optimizer'; if(hi(s.O)&&s.N<3.3) return 'Design-Forward Adventurer'; return 'Balanced Explorer'; })(scores);
      $('#archetype').textContent=`Archetype: ${arch}`;
      const mb=scoresToMBTI(scores);
      const blurb=MBTI_BUYER_GUIDE[mb.type] || "Personality informs your tradeoffs; we’ll size budget first, then match how you live.";
      $('#mbti').innerHTML=`MBTI: <b>${mb.type}</b> — ${mbtiLabel(mb.type)} <span style="opacity:.7">(${(mb.confidence*100).toFixed(0)}% match)</span><br/><span class="sub">${blurb}</span>`;
      $('#consistency').innerHTML=inconsistencies.length ? `<span class="flag">⚠ Consistency flags:</span> ${inconsistencies.join(', ')}` : `<span class="ok">✓ Responses appear consistent across rephrased items.</span>`;
      const brief={
        version:'aiou.v3.timed', ts:new Date().toISOString(),
        profile:{
          firstName: $('#firstName').value.trim(),
          lastName:  $('#lastName').value.trim(),
          bedrooms:  Number($('#bedrooms').value||0),
          budgetMax: Number($('#budget').value||0),
          setting:   $('#setting').value,
          safetyPriority: Number($('#safety').value||3)
        },
        scores, archetype: arch, mbti: mb,
        psych:{ totalItems: Q.length, inconsistencies },
        visual:{ styleVsPriceSlider: Number(window.__STYLE_V_PRICE ?? 0) }
      };
      $('#json').textContent=JSON.stringify(brief,null,2);
      $('#results').style.display='block';
      $('#btnCopy').onclick=()=>navigator.clipboard.writeText(JSON.stringify(brief,null,2));
      $('#btnReport').onclick=()=>sendToLLM(brief);
    }
    async function sendToLLM(brief){
      const ENDPOINT=(document.querySelector('#aiou-shell')?.dataset?.endpoint || 'https://theorozcorealty.netlify.app/.netlify/functions/aiou-report').trim();
      $('#llmOut').innerHTML='<div class="sub">Generating…</div>';
      try{
        const r=await fetch(ENDPOINT,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(brief)});
        if(!r.ok) throw new Error('Server returned '+r.status);
        const data=await r.json();
        const html=data.memoHtml || (data.memo ? `<p>${String(data.memo).replace(/</g,'&lt;')}</p>` : '');
        $('#llmOut').innerHTML = html || '<div class="flag">No memo returned.</div>';
        if (data.hydratedProfile) {
          if (!$('#firstName').value && data.hydratedProfile.firstName) $('#firstName').value = data.hydratedProfile.firstName;
          if (!$('#lastName').value  && data.hydratedProfile.lastName)  $('#lastName').value  = data.hydratedProfile.lastName;
        }
      }catch(e){
        $('#llmOut').innerHTML=`<div class="flag">Error: ${e.message}</div>`;
      }
    }
    /* Controls */
    $('#startQuiz').addEventListener('click', start);
    $('#skip').addEventListener('click', ()=>{ record(null); });
    $('#reset').addEventListener('click', ()=>{ if (overallTimer) clearInterval(overallTimer); location.reload(); });
    $('#closePortal').addEventListener('click', ()=>{ if (overallTimer) clearInterval(overallTimer); portal.remove(); });
  })();
  </script>
        </div>
      </div>
      <section></section>
    </section>
  </section>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=68cecb820ec3dbdca3ef9099" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="../js/webflow.js" type="text/javascript"></script>
</body>
</html>