<!DOCTYPE html><!--  This site was created in Webflow. https://webflow.com  --><!--  Last Published: Fri Oct 31 2025 03:23:53 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="68d5fc11b55d1fc05f41ed8c" data-wf-site="68cecb820ec3dbdca3ef9099" lang="en">
<head>
  <meta charset="utf-8">
  <title>Analyze</title>
  <meta content="Analyze" property="og:title">
  <meta content="Analyze" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="../css/normalize.css" rel="stylesheet" type="text/css">
  <link href="../css/webflow.css" rel="stylesheet" type="text/css">
  <link href="../css/new-real-estate-purchase.webflow.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Droid Serif:400,400italic,700,700italic","PT Serif:400,400italic,700,700italic","Bitter:400,700,400italic","Vollkorn:400,400italic,700,700italic","Varela:400","Lato:100,100italic,300,300italic,400,400italic,700,700italic,900,900italic","Great Vibes:400","Merriweather:300,300italic,400,400italic,700,700italic,900,900italic","Exo:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","DM Sans:300,regular,500,600,700","Gilda Display:regular","Barlow Condensed:regular","Barlow:300italic,regular,italic,500","Material Icons Outlined:regular","Material Icons:regular"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="../images/favicon.svg" rel="shortcut icon" type="image/x-icon">
  <link href="../images/webclip.jpg" rel="apple-touch-icon">
</head>
<body class="body-6">
  <header class="style-two-header">
    <div data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar-logo-left-container style-three-header-container w-nav">
      <div class="container-two">
        <div class="navbar-wrapper">
          <div class="style-three-nav-brand">
            <a href="#" role="link" class="home-three-nav-menu-brand rezoid w-nav-brand"><img src="../images/TOR.png" loading="lazy" width="122" height="25" alt="" srcset="../images/1394a00d76ce9dd861ade690dfb1a058_TOR-p-500.png 500w, ../images/1394a00d76ce9dd861ade690dfb1a058_TOR-p-800.png 800w, ../images/1394a00d76ce9dd861ade690dfb1a058_TOR-p-1080.png 1080w, ../images/1394a00d76ce9dd861ade690dfb1a058_TOR-p-1600.png 1600w, ../images/1394a00d76ce9dd861ade690dfb1a058_TOR-p-2000.png 2000w, ../images/1394a00d76ce9dd861ade690dfb1a058_TOR-p-2600.png 2600w, ../images/TOR.png 2851w" sizes="122px"></a>
          </div>
          <div class="w-layout-hflex nav-link-box">
            <div class="w-layout-hflex nav-one-button-wrap">
              <div class="menu-button w-nav-button"><img src="../images/Icon-nav-1.svg" loading="lazy" width="31" height="18" alt="Hambarger Menu"></div>
            </div>
          </div>
          <a role="link" data-w-id="0bce0368-0fe1-581a-dd23-1c4da305c7bd" href="tel:+1800456789" class="style-three-phone-button responsive-hidden w-inline-block">
            <div class="home-three-call-button-text">
              <div class="style-three-phone-button-txt">Lets Talk</div>
              <div class="style-three-phone-button-txt">(800) 456 7890</div>
            </div>
            <div class="home-three-button-icon"><img src="../images/Call-Icon.svg" loading="lazy" width="46" height="46" alt="Call Icon" class="image"></div>
          </a>
          <div class="navbar-wrapper-2">
            <div class="style-three-nav-brand">
              <a href="#" role="link" class="home-three-nav-menu-brand rezoid w-nav-brand"></a>
            </div>
            <div class="w-layout-hflex nav-link-box">
              <nav role="navigation" class="nav-menu-wrapper-3 w-nav-menu">
                <ul role="list" class="nav-menu-two w-list-unstyled">
                  <li class="list-item-3 nav-five-list">
                    <div data-delay="0" data-hover="true" data-w-id="3648297c-ddce-044b-87fb-9eff0b3055a7" class="home-three-dropdaown-2 w-dropdown">
                      <div class="style-three-menu-dropdown-toggle-3 w-dropdown-toggle">
                        <div class="home-three-dropdown">
                          <div class="home-three-dropdown-menu black-color">Home </div>
                          <div class="home-three-dropdown-menu black-color">Home </div>
                        </div><img width="9" height="9" alt="Plus" src="../images/Plus.svg" loading="lazy" class="home-three-dropdown-icon">
                      </div>
                      <nav class="home-three-dropdown-list w-dropdown-list">
                        <div class="home-three-dropdown-block">
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Home One</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Home Two</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Home Three</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Home Four</a>
                        </div>
                      </nav>
                    </div>
                  </li>
                  <li class="list-item-3 nav-five-list">
                    <div data-delay="0" data-hover="true" data-w-id="3648297c-ddce-044b-87fb-9eff0b3055ba" class="home-three-dropdaown-2 w-dropdown">
                      <div class="style-three-menu-dropdown-toggle-3 w-dropdown-toggle">
                        <div class="home-three-dropdown">
                          <div class="home-three-dropdown-menu black-color">FEATURES</div>
                          <div class="home-three-dropdown-menu black-color">Properties</div>
                        </div><img width="9" height="9" alt="Plus" src="../images/Plus.svg" loading="lazy" class="home-three-dropdown-icon">
                      </div>
                      <nav class="home-three-dropdown-list w-dropdown-list">
                        <div class="home-three-dropdown-block">
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Property One</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Property Two</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Property Three</a>
                          <a href="https://rezoid.webflow.io/properties/the-mertilex-complex-3" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Property Details One</a>
                          <a href="https://rezoid.webflow.io/property-two/house-block-renovate" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Property Details Two</a>
                        </div>
                      </nav>
                    </div>
                  </li>
                  <li class="list-item-3 nav-five-list">
                    <div data-delay="0" data-hover="true" data-w-id="3648297c-ddce-044b-87fb-9eff0b3055d2" class="home-three-dropdaown-2 w-dropdown">
                      <div class="style-three-menu-dropdown-toggle-3 w-dropdown-toggle">
                        <div class="home-three-dropdown">
                          <div class="home-three-dropdown-menu black-color">ABOUT US</div>
                          <div class="home-three-dropdown-menu black-color">Pages</div>
                        </div><img width="9" height="9" alt="Plus" src="../images/Plus.svg" loading="lazy" class="home-three-dropdown-icon">
                      </div>
                      <nav class="home-three-dropdown-list w-dropdown-list">
                        <div class="home-three-dropdown-block">
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">About One</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">About Two</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">About Three</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Service One</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Service Two</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Agent One</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Agent Two</a>
                          <a href="https://rezoid.webflow.io/agent/francine-lawson" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Agent Details</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Listing Property</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Book Consultation</a>
                          <a href="https://rezoid.webflow.io/location/las-vegas" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Property Location</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">FAQ</a>
                          <a href="https://rezoid.webflow.io/search" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Search Result</a>
                          <a href="https://rezoid.webflow.io/information/licensing" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Licensing</a>
                          <a href="https://rezoid.webflow.io/information/style-guide" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Style Guide</a>
                          <a href="https://rezoid.webflow.io/404" role="link" class="home-three-dropdown-link-2 w-dropdown-link">404</a>
                          <a href="https://rezoid.webflow.io/401" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Password Protected</a>
                        </div>
                      </nav>
                    </div>
                  </li>
                  <li class="list-item-3 nav-five-list">
                    <div data-delay="0" data-hover="true" data-w-id="3648297c-ddce-044b-87fb-9eff0b3055ff" class="home-three-dropdaown-2 w-dropdown">
                      <div class="style-three-menu-dropdown-toggle-3 w-dropdown-toggle">
                        <div class="home-three-dropdown">
                          <div class="home-three-dropdown-menu black-color">Blog</div>
                          <div class="home-three-dropdown-menu black-color">Blog</div>
                        </div><img width="9" height="9" alt="Plus" src="../images/Plus.svg" loading="lazy" class="home-three-dropdown-icon">
                      </div>
                      <nav class="home-three-dropdown-list w-dropdown-list">
                        <div class="home-three-dropdown-block">
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Blog One</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Blog Two</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Blog Three</a>
                          <a href="https://rezoid.webflow.io/blog/unlocking-home-ownership-your-ultimate-guide-to-buying-an-apartment" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Blog Details One</a>
                          <a href="https://rezoid.webflow.io/blog-two/unlocking-homeownership-your-ultimate-guide-to-buying-an-apartment" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Blog Details Two</a>
                        </div>
                      </nav>
                    </div>
                  </li>
                  <li class="list-item-3 nav-five-list">
                    <div data-delay="0" data-hover="true" data-w-id="3648297c-ddce-044b-87fb-9eff0b305614" class="home-three-dropdaown-2 w-dropdown">
                      <div class="style-three-menu-dropdown-toggle-3 w-dropdown-toggle">
                        <div class="home-three-dropdown">
                          <div class="home-three-dropdown-menu black-color"></div>
                          <div class="home-three-dropdown-menu black-color">Contact</div>
                        </div>
                      </div>
                      <nav class="home-three-dropdown-list w-dropdown-list">
                        <div class="home-three-dropdown-block">
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Contact One</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Contact Two</a>
                          <a href="#" role="link" class="home-three-dropdown-link-2 w-dropdown-link">Contact Three</a>
                        </div>
                      </nav>
                    </div>
                  </li>
                </ul>
              </nav>
              <div class="w-layout-hflex nav-one-button-wrap">
                <a href="#" role="button" data-w-id="3648297c-ddce-044b-87fb-9eff0b30565b" class="hero-button-3 nav-button w-inline-block">
                  <div class="button-mask">
                    <div class="link-text-wrp">
                      <div>Contact us</div>
                      <div class="secondt-btn-text">Contact us</div>
                    </div>
                  </div>
                </a>
                <div class="menu-button-2 w-nav-button"><img width="31" height="18" alt="Hambarger Menu" src="../images/Icon-nav-1.svg" loading="lazy"></div>
              </div>
            </div>
            <a role="link" data-w-id="3648297c-ddce-044b-87fb-9eff0b305664" href="tel:+1800456789" class="style-three-phone-button responsive-hidden w-inline-block">
              <div class="home-three-call-button-text">
                <div class="style-three-phone-button-txt">Lets Talk</div>
                <div class="style-three-phone-button-txt">(800) 456 7890</div>
              </div>
              <div class="home-three-button-icon"><img width="46" height="46" alt="Call Icon" src="../images/Call-Icon.svg" loading="lazy" class="image-71"></div>
            </a>
          </div>
        </div>
      </div>
    </div>
    <section>
      <div class="w-embed w-script"><!--  =========================================================
  RealtySaSS • Frosted Glass Lock (Global • ONLY lock /realtysass)
  - Keep ONE embed sitewide.
  - Locks pages that MATCH ALLOW_PATHS (allow-list mode).
  - All other pages are OPEN (no prompt).
=========================================================  -->
        <div id="rs-lock-overlay" aria-hidden="true" style="visibility:hidden; opacity:0;">
          <div class="rs-lock-centered" role="dialog" aria-labelledby="rs-lock-title" aria-modal="true">
            <div class="rs-lock-card" id="rs-lock-card">
              <h1 id="rs-lock-title">Enter Your 6-Digit Access Code</h1>
              <p class="rs-lock-sub">This page is private — please enter the unlock code we provided.</p>
              <div class="rs-code-row">
                <input id="rs-code-input" inputmode="numeric" maxlength="6" pattern="[0-9]*" autocomplete="one-time-code" aria-label="6-digit code">
                <button id="rs-code-btn" type="button">Unlock</button>
              </div>
              <p id="rs-lock-msg" class="rs-lock-msg" aria-live="polite"></p>
            </div>
          </div>
        </div>
        <style>
  :root{
    --rs-overlay-bg: rgba(6,10,18,0.55);
    --rs-accent: #8ef3c5;
    --rs-ink: #e9ecff;
    --rs-muted: #a8b0d6;
    --rs-radius: 14px;
  }
  #rs-lock-overlay{
    position:fixed; inset:0; width:100%; height:100%;
    z-index:99999; display:flex; align-items:center; justify-content:center;
    background:var(--rs-overlay-bg);
    backdrop-filter:blur(10px) saturate(120%);
    -webkit-backdrop-filter:blur(10px) saturate(120%);
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    transition:opacity .25s ease, visibility .25s ease;
  }
  #rs-lock-overlay.rs-hidden{ opacity:0; pointer-events:none; visibility:hidden; }
  .rs-lock-centered{ width:100%; max-width:520px; padding:20px; }
  .rs-lock-card{
    background:rgba(255,255,255,0.03);
    border-radius:var(--rs-radius);
    border:1px solid rgba(255,255,255,0.06);
    box-shadow:0 8px 30px rgba(3,6,15,0.6);
    padding:28px 24px; color:var(--rs-ink);
  }
  .rs-lock-card h1{ margin:0 0 8px; font-size:20px; font-weight:700; }
  .rs-lock-sub{ margin:0 0 18px; color:var(--rs-muted); font-size:13px; }
  .rs-code-row{ display:flex; gap:12px; }
  #rs-code-input{
    flex:1; padding:12px 14px; border-radius:10px;
    border:1px solid rgba(255,255,255,0.06);
    background:rgba(255,255,255,0.02);
    color:var(--rs-ink); font-size:16px; outline:none;
  }
  #rs-code-btn{
    padding:11px 16px; border-radius:10px; border:none;
    background:linear-gradient(180deg,var(--rs-accent),rgba(100,230,190,0.85));
    color:#02110b; font-weight:700; cursor:pointer;
  }
  .rs-lock-msg{ margin-top:12px; color:var(--rs-muted); font-size:13px; min-height:18px; }
</style>
        <script>
(function(){
  "use strict";
  // --- CONFIG ---
  const VALID_CODE = "123456";   // <--- your 6-digit code (numbers only)
  // Allow-list mode: ONLY paths that match ALLOW_PATHS will be locked.
  const USE_ALLOW_LIST = true;
  const ALLOW_PATHS = [
    /\/realtysass\/?$/i,            // exactly /realtysass (with optional trailing slash)
    // If you also have a subpage like /realtysass/something, add another line, e.g.:
    // /\/realtysass\/.+/i,
  ];
  // (EXEMPT_PATHS is ignored in allow-list mode, but keeping here for reference)
  const EXEMPT_PATHS = [];
  // --- PAGE DECISION ---
  const path = (location.pathname || "/").toLowerCase();
  const isAllowed = ALLOW_PATHS.some(re => re.test(path));
  const shouldLock = USE_ALLOW_LIST ? isAllowed : !EXEMPT_PATHS.some(re => re.test(path));
  // If this page shouldn't be locked, remove all overlays and exit.
  if (!shouldLock) {
    document.querySelectorAll('#rs-lock-overlay').forEach(el => el.remove());
    return;
  }
  // --- ELEMENTS ---
  const overlay = document.getElementById('rs-lock-overlay');
  const input   = document.getElementById('rs-code-input');
  const btn     = document.getElementById('rs-code-btn');
  const msg     = document.getElementById('rs-lock-msg');
  // Show overlay now (we start hidden so non-locked pages never flash)
  overlay.classList.remove('rs-hidden');
  overlay.setAttribute('aria-hidden','false');
  overlay.style.visibility = 'visible';
  overlay.style.opacity = '1';
  // --- HELPERS ---
  const digitsOnly = s => String(s || '').replace(/\D+/g, '');
  const cleanCode  = s => digitsOnly(s).slice(0, 6);
  function showMsg(text, isError){
    msg.textContent = text || '';
    msg.style.color = isError ? '#ffb3b3' : 'var(--rs-muted)';
  }
  function unlockAllOverlays(){
    // Hide EVERY instance (handles duplicate embeds in Symbols)
    document.querySelectorAll('#rs-lock-overlay').forEach(el => {
      el.classList.add('rs-hidden');
      el.setAttribute('aria-hidden','true');
      el.style.visibility = 'hidden';
      el.style.opacity = '0';
    });
  }
  function onSubmit(){
    const entered  = cleanCode(input.value);
    const expected = cleanCode(VALID_CODE);
    if (entered.length !== 6){
      showMsg('Please enter a valid 6-digit code.', true);
      return;
    }
    if (entered === expected){
      unlockAllOverlays();
      showMsg('');
    } else {
      showMsg('That code is not valid. Try again.', true);
      const card = document.getElementById('rs-lock-card');
      if(card && card.animate){
        card.animate(
          [{transform:'translateX(-5px)'},{transform:'translateX(5px)'},{transform:'translateX(0)'}],
          {duration:260}
        );
      }
    }
  }
  // --- EVENTS ---
  if (btn) btn.addEventListener('click', onSubmit);
  if (input){
    input.addEventListener('keydown', e => { if (e.key === 'Enter') onSubmit(); });
    setTimeout(()=> input.focus(), 0);
  }
})();
</script>
      </div>
    </section>
  </header>
  <section class="section-169">
    <div class="code-embed-17 w-embed w-script"><!--  ============================
  Fiduciary Snapshot — v3.7.3 (Fixed for Webflow)
  - Keeps luxury 3D panel design
  - Chart.js loads safely
  - Never shows blank
============================  -->
      <section id="fid-fullscreen-shell" style="all: initial;">
        <!--  Chart.js direct CDN (no proxy)  -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
        <style>
    /* #1 GLOBAL RESET FOR THIS WIDGET ONLY */
    #fid-fullscreen-shell,
    #fid-fullscreen-shell * {
      box-sizing: border-box;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    /* Full-bleed dark app zone behind everything */
    #fid-fullscreen-shell {
      width: 100vw;
      max-width: 100vw;
      overflow-x: auto;
      background: #0b0b12; /* rich near-black */
      color: #e9ecff;
      padding-top: 24px;
      padding-bottom: 64px;
    }
    /* Inner shell: stop Webflow from squeezing */
    #fid-snapshot-shell {
      width: 100%;
      max-width: 100vw;
      min-width: 1024px; /* do not collapse on desktop */
      margin: 0;
      padding: 0 24px 0 24px;
    }
    :root{
      --bg:#0f1220;
      --panel:#15192b;
      --card:#181b2e;
      --ink:#e9ecff;
      --muted:#a8b0d6;
      --accent:#6aa7ff;
      --accent2:#8ef3c5;
      --ok:#55d399;
      --warn:#f9c74f;
      --bad:#ff6b6b;
    }
    /* MAIN CARD WRAPPER */
    #fid-card {
      background: var(--card);
      border: 1px solid rgba(255,255,255,.08);
      border-radius: 18px;
      box-shadow: 0 10px 24px rgba(0,0,0,.35);
      padding: 18px;
      position: relative;
      color: var(--ink);
      width: 100%;
    }
    /* HEADER ROW: grade chip + export */
    .fid-row {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 16px;
      align-items: flex-start;
    }
    @media (max-width:840px){
      .fid-row {
        grid-template-columns: 1fr;
      }
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.08);
      background:#0f1326;
      white-space:nowrap;
      color:var(--ink);
      font-size:13px;
      line-height:1.2;
    }
    .dot{
      width:12px;
      height:12px;
      border-radius:50%;
    }
    .mini-wrap{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .mini-meter{
      width:160px;
      height:8px;
      border-radius:999px;
      background:#0b0f23;
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
    }
    .mini-meter > div{
      height:100%;
      width:0%;
      background:linear-gradient(90deg,var(--accent2),#f9c74f,#ff6b6b);
    }
    .export{
      padding:10px 14px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.14);
      background:#0f1326;
      color:#e9ecff;
      cursor:pointer;
      font-size:13px;
      line-height:1.2;
    }
    .export:hover{ filter:brightness(1.15); }
    /* KPI STRIP */
    .kpi-strip{
      display:grid;
      grid-template-columns:repeat(5,minmax(0,1fr));
      gap:18px;
      margin-top:18px;
    }
    @media (max-width:1280px){
      .kpi-strip{ grid-template-columns:repeat(3,minmax(0,1fr)); }
    }
    @media (max-width:760px){
      .kpi-strip{ grid-template-columns:repeat(2,minmax(0,1fr)); }
    }
    @media (max-width:520px){
      .kpi-strip{ grid-template-columns:1fr; }
    }
    .kpi-card{
      background:#12162b;
      border:1px solid rgba(255,255,255,.06);
      border-radius:14px;
      padding:14px;
      min-height:76px;
      color:var(--ink);
      box-shadow:0 16px 32px rgba(0,0,0,.6);
    }
    .kpi-title{
      font-size:12px;
      color:var(--muted);
      letter-spacing:.2px;
      text-transform:uppercase;
    }
    .kpi-val{
      margin-top:8px;
      font-weight:700;
      font-size:20px;
      display:flex;
      align-items:center;
      gap:8px;
      color:var(--ink);
      line-height:1.2;
    }
    .delta{
      font-size:11px;
      margin-left:8px;
      padding:2px 6px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(85,211,153,.10);
      color:var(--ok);
      line-height:1.2;
    }
    /* CREDIT SCORE STRIP inside KPI */
    .score-bar{
      position:relative;
      width:100%;
      height:10px;
      border-radius:999px;
      background:linear-gradient(90deg,#ff6b6b,#f9c74f,#55d399);
      margin-top:8px;
    }
    .score-marker{
      position:absolute;
      top:-3px;
      width:2px;
      height:16px;
      background:#e9ecff;
      border-radius:2px;
      left:0%;
      box-shadow:0 0 6px rgba(255,255,255,.6);
    }
    /* MID GRID (Pie left, Bar right) */
    .mid{
      display:grid;
      grid-template-columns:480px 1fr;
      gap:18px;
      margin-top:18px;
      align-items:stretch;
    }
    @media (max-width:1080px){
      .mid{ grid-template-columns:1fr; }
    }
    .card-mini{
      background:#12162b;
      border:1px solid rgba(255,255,255,.06);
      border-radius:16px;
      padding:16px;
      display:flex;
      flex-direction:column;
      color:var(--ink);
      box-shadow:0 16px 32px rgba(0,0,0,.6);
    }
    .card-mini h3{
      margin:0 0 12px;
      font-size:14px;
      color:#cfd5ff;
      font-weight:700;
      letter-spacing:.3px;
      text-transform:uppercase;
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
    }
    .chart-holder{
      position:relative;
      height: clamp(220px, 36vh, 420px);
      width:100%;
      display:block;
      overflow:hidden;
      border-radius:12px;
      background:#0f1220;
      border:1px solid rgba(255,255,255,.05);
      box-shadow:0 24px 48px rgba(0,0,0,.8) inset;
    }
    /* Pie taller */
    .card-mini:first-child .chart-holder{
      height: clamp(280px, 42vh, 460px);
    }
    canvas{
      width:100% !important;
      height:100% !important;
      display:block;
    }
    .ring-center{
      position:absolute;
      inset:0;
      display:grid;
      place-items:center;
      pointer-events:none;
      font-weight:800;
      font-size:28px;
      color:#e9ecff;
      text-shadow:0 0 18px rgba(0,0,0,.5);
    }
    .legend{
      display:flex;
      gap:16px;
      margin-top:10px;
      flex-wrap:wrap;
      color:#a8b0d6;
      font-size:12px;
    }
    .l-pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .l-dot{
      width:10px;
      height:10px;
      border-radius:999px;
      background:#6aa7ff;
      box-shadow:0 0 8px rgba(106,167,255,.6);
    }
    /* EXPENSE CONTROLS (right card top row of bar chart) */
    .controls{
      display:flex;
      gap:10px;
      align-items:center;
      margin:4px 0 10px;
      flex-wrap:wrap;
    }
    .select{
      background:#0f1326;
      color:#e9ecff;
      border:1px solid rgba(255,255,255,.10);
      border-radius:10px;
      padding:8px 10px;
      font-size:12px;
    }
    .toggle{
      cursor:pointer;
      padding:6px 10px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.10);
      background:#0f1326;
      font-size:12px;
      color:#e9ecff;
      line-height:1.2;
    }
    .toggle[aria-pressed="true"]{
      background:#192041;
      border-color:rgba(255,255,255,.22);
    }
    /* BOTTOM: RENT VS BUY */
    .bottom{
      background:#12162b;
      border:1px solid rgba(255,255,255,.06);
      border-radius:16px;
      padding:16px;
      margin-top:18px;
      color:var(--ink);
      box-shadow:0 16px 32px rgba(0,0,0,.6);
    }
    .row-slim{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:8px;
      flex-wrap:wrap;
    }
    .h4{
      font-weight:800;
      letter-spacing:.2px;
      color:var(--ink);
      font-size:14px;
      text-transform:uppercase;
    }
    .rent-ctrl{
      display:flex;
      align-items:center;
      gap:10px;
      margin-left:auto;
      flex-wrap:wrap;
    }
    .rent-label{
      font-size:11px;
      color:var(--muted);
      line-height:1.2;
      text-transform:uppercase;
      letter-spacing:.3px;
    }
    .rent-select{
      appearance:none;
      background:#0f1326;
      color:#e9ecff;
      border:1px solid rgba(255,255,255,.12);
      border-radius:10px;
      padding:8px 10px;
      min-width:140px;
      cursor:pointer;
      font-size:12px;
      line-height:1.2;
    }
    .muted{
      color:var(--muted);
      font-size:12px;
      line-height:1.4;
    }
    @media print{
      body, html{ background:#fff !important; }
    }
  </style>
        <!--  DASHBOARD BODY  -->
        <div id="fid-snapshot" style="all: initial;">
          <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
          <div id="fid-snapshot-shell">
            <div id="fid-card">
              <!--  TOP HEADER ROW  -->
              <div class="fid-row">
                <span class="badge" id="grade-chip">
                  <span id="fid-dot" class="dot" style="background:#888"></span>
                  <div class="mini-wrap">
                    <div>
                      <b id="fid-grade">Loading...</b>
                      <span id="fid-disp" style="margin-left:8px; opacity:.85">$0</span>
                    </div>
                    <div class="mini-meter" aria-label="grade-meter">
                      <div id="fid-meter"></div>
                    </div>
                  </div>
                </span>
                <button id="fid-export" class="export">Export ▾</button>
              </div>
              <!--  KPI STRIP  -->
              <div class="kpi-strip">
                <div class="kpi-card">
                  <div class="kpi-title">Total Monthly Income</div>
                  <div class="kpi-val">
                    <span id="k-income">$0</span>
                    <span class="delta" id="k-inc-delta">+0%</span>
                  </div>
                </div>
                <div class="kpi-card">
                  <div class="kpi-title">Total Monthly Expense</div>
                  <div class="kpi-val">
                    <span id="k-expense">$0</span>
                    <span class="delta" id="k-exp-delta" style="background:rgba(255,107,107,.12); color:var(--bad);">+0%</span>
                  </div>
                </div>
                <div class="kpi-card">
                  <div class="kpi-title">Mortgage Estimate</div>
                  <div class="kpi-val" id="k-mtg">$0</div>
                </div>
                <div class="kpi-card">
                  <div class="kpi-title">Total Savings</div>
                  <div class="kpi-val">
                    <span id="k-save">$0</span>
                    <span class="delta" id="k-sav-delta">+1.3%</span>
                  </div>
                </div>
                <div class="kpi-card">
                  <div class="kpi-title">
                    Credit Score <span id="score-band" style="margin-left:6px; font-weight:700;"></span>
                  </div>
                  <div class="kpi-val"><span id="k-score">—</span></div>
                  <div class="score-bar">
                    <div id="score-marker" class="score-marker"></div>
                  </div>
                </div>
              </div>
              <!--  MID GRID  -->
              <div class="mid">
                <!--  PIE SIDE  -->
                <div class="card-mini">
                  <h3>
                    <span>OVERALL BUDGET</span>
                    <span style="color:var(--muted);font-size:11px;font-weight:400;text-transform:none;">
                      Spending vs savings vs leftover
                    </span>
                  </h3>
                  <div class="chart-holder">
                    <canvas id="fid-pie"></canvas>
                    <div class="ring-center" id="pie-center">0</div>
                  </div>
                  <div class="legend">
                    <span class="l-pill">
                      <span class="l-dot" style="background:#6aa7ff;box-shadow:0 0 8px rgba(106,167,255,.6);"></span>
                      Expenses
                    </span>
                    <span class="l-pill">
                      <span class="l-dot" style="background:#55d399;box-shadow:0 0 8px rgba(85,211,153,.6);"></span>
                      Mortgage
                    </span>
                    <span class="l-pill">
                      <span class="l-dot" style="background:#8ef3c5;box-shadow:0 0 8px rgba(142,243,197,.6);"></span>
                      Savings
                    </span>
                    <span class="l-pill">
                      <span class="l-dot" style="background:#f9c74f;box-shadow:0 0 8px rgba(249,199,79,.6);"></span>
                      Disposable
                    </span>
                  </div>
                </div>
                <!--  BAR SIDE  -->
                <div class="card-mini">
                  <h3>
                    <span>MONTHLY EXPENSES INTELLIGENCE</span>
                    <span style="color:var(--muted);font-size:11px;font-weight:400;text-transform:none;">
                      This month by category
                    </span>
                  </h3>
                  <div class="controls">
                    <button id="mode-abs" class="toggle" aria-pressed="true">$ Totals</button>
                    <button id="mode-pct" class="toggle" aria-pressed="false">% Composition</button>
                    <select id="exp-view" class="select">
                      <option value="monthly" selected="">Monthly</option>
                      <option value="yearly">Yearly</option>
                    </select>
                  </div>
                  <div class="chart-holder">
                    <canvas id="fid-bars"></canvas>
                  </div>
                  <div class="muted" style="margin-top:8px">
                    Monthly view shows categories; Yearly view shows months.
                    Toggle $ / % to switch measure.
                  </div>
                </div>
              </div>
              <!--  RENT VS BUY  -->
              <div class="bottom">
                <div class="row-slim">
                  <div class="h4">RENT vs BUY — NET COST</div>
                  <div class="rent-ctrl">
                    <span class="badge" title="Starting monthly rent used for the 10-year comparison" style="gap:8px;">
                      <span class="rent-label">Rent Price (mo)</span>
                      <select id="rent-select" class="rent-select"></select>
                    </span>
                    <span class="badge" title="Years until Net Cost of Buying ≤ Renting" style="margin-left:6px;">
                      <div style="display:flex; flex-direction:column; line-height:1.1;">
                        <span style="font-size:11px; color:var(--muted)">Break-even (Years)</span>
                        <b id="be-yrs" style="font-size:16px;">—</b>
                      </div>
                    </span>
                  </div>
                </div>
                <div class="chart-holder" style="height: clamp(240px, 36vh, 400px);">
                  <canvas id="fid-line"></canvas>
                </div>
              </div>
              <div class="muted" style="margin-top:10px">
                Outputs are educational, not advice.
              </div>
            </div>
          </div>
        </div>
        <!--  CORE LOGIC  -->
        <script>
  document.addEventListener("DOMContentLoaded", () => {
    if (window.__FIDUCIARY_WIDGET_MOUNTED__) return;
    window.__FIDUCIARY_WIDGET_MOUNTED__ = true;
    /* ---------- Helpers ---------- */
    const $  = (q) => document.querySelector(q);
    const cur0 = (n) => "$" + (Number(n)||0).toLocaleString("en-US",{maximumFractionDigits:0});
    const rnd = (min,max)=> Math.round(min + Math.random()*(max-min));
    /* ---------- Pull bridge / fallback ---------- */
    let bridge;
    try {
      bridge = JSON.parse(localStorage.getItem("realtysass.bridge"));
    } catch (_) {}
    if (!bridge) {
      bridge = {
        income: 7800,
        expenses: 3900,
        savings: 650,
        housing: 2100,          // fallback mortgage+TI/HOA
        price: 320000,
        apr: 7.0,
        creditScore: 725,
        termYears: 30,
        tihoa: 400,
        pmi: 0,
        pAndI: 1700,
        dpAmt: 64000,
        dpPct: 20,
        itemizedRows: [
          { name:"Rent / Housing", amount:1800, cat:"Housing" },
          { name:"Utilities", amount:300, cat:"Utilities" },
          { name:"Groceries", amount:500, cat:"Food" },
          { name:"Health", amount:200, cat:"Health" },
          { name:"Fun", amount:150, cat:"Entertainment" }
        ]
      };
    }
    /* ---------- Grade calc ---------- */
    function computeGrade(snap){
      // total share of income being burned
      const totalShare = (snap.expenses + snap.savings + snap.housing) / (snap.income||1);
      const housingShare = snap.housing / (snap.income||1);
      let g=92;
      if(totalShare>=0.85) g-=30; else if(totalShare>=0.70) g-=15; else g+=4;
      if(housingShare>0.40) g-=18; else if(housingShare>0.33) g-=8; else g+=4;
      if(snap.income - snap.expenses - snap.savings - snap.housing < 0) g-=30;
      const sr=snap.savings/(snap.income||1);
      if(sr<0.10) g-=8; else if(sr>=0.20) g+=4;
      g=Math.max(0,Math.min(100,g));
      const letter = g>=98?'A+': g>=92?'A': g>=88?'A-'
                   : g>=82?'B+': g>=76?'B': g>=72?'B-'
                   : g>=66?'C+': g>=60?'C': g>=55?'C-'
                   : g>=50?'D+': g>=45?'D':'F';
      return {letter,totalShare};
    }
    /* ---------- Charts ---------- */
    let pieChart, barChart, lineChart;
    function initCharts(){
      const pieCtx = document.getElementById("fid-pie").getContext("2d");
      const barCtx = document.getElementById("fid-bars").getContext("2d");
      const lineCtx= document.getElementById("fid-line").getContext("2d");
      pieChart = new Chart(pieCtx,{
        type:"doughnut",
        data:{
          labels:["Expenses","Mortgage","Savings","Disposable"],
          datasets:[{
            data:[0,0,0,1],
            backgroundColor:["#6aa7ff","#55d399","#8ef3c5","#f9c74f"],
            borderWidth:0
          }]
        },
        options:{
          cutout:"66%",
          plugins:{ legend:{ display:false } },
          responsive:true,
          maintainAspectRatio:false
        }
      });
      barChart = new Chart(barCtx,{
        type:"bar",
        data:{ labels:[], datasets:[] },
        options:{
          plugins:{
            legend:{ labels:{ color:"#cfd5ff", boxWidth:12 }, display:true }
          },
          scales:{
            x:{ ticks:{ color:"#cfd5ff" }, grid:{ color:"rgba(255,255,255,.06)" } },
            y:{ ticks:{ color:"#cfd5ff" }, grid:{ color:"rgba(255,255,255,.06)" } }
          },
          responsive:true,
          maintainAspectRatio:false,
          datasets:{ bar:{ borderWidth:0, borderRadius:6 } }
        }
      });
      lineChart = new Chart(lineCtx,{
        type:"line",
        data:{
          labels:[],
          datasets:[
            {
              label:"Buy – Net Cost",
              data:[],
              tension:.35,
              fill:false,
              borderWidth:2,
              pointRadius:0,
              borderColor:"#6aa7ff"
            },
            {
              label:"Rent – Net Cost",
              data:[],
              tension:.35,
              fill:false,
              borderWidth:2,
              pointRadius:0,
              borderColor:"#55d399"
            }
          ]
        },
        options:{
          plugins:{
            legend:{ display:true, labels:{ color:"#cfd5ff" } },
            tooltip:{
              callbacks:{
                label:(c)=>{
                  const lbl = c.dataset.label + ": " + cur0(c.raw);
                  return lbl;
                }
              }
            }
          },
          scales:{
            x:{ ticks:{ color:"#cfd5ff" }, grid:{ display:false } },
            y:{ ticks:{ color:"#cfd5ff" }, grid:{ color:"rgba(255,255,255,.06)" } }
          },
          responsive:true,
          maintainAspectRatio:false
        }
      });
      // keep charts responsive to panel resize
      const ro = new ResizeObserver(()=>{
        pieChart?.resize();
        barChart?.resize();
        lineChart?.resize();
      });
      document.querySelectorAll('#fid-fullscreen-shell .chart-holder').forEach(h=> ro.observe(h));
    }
    /* ---------- Buckets for bar chart ---------- */
    const bucketOrder = ["Housing","Utilities","Food","Health","Entertainment","Other"];
    function buildBucketsFromBridge(){
      // We will just aggregate the itemizedRows fallback for now
      const catMap = {Housing:0,Utilities:0,Food:0,Health:0,Entertainment:0,Other:0};
      (bridge.itemizedRows||[]).forEach(r=>{
        const cat = bucketOrder.includes(r.cat) ? r.cat : "Other";
        catMap[cat] += Number(r.amount||0);
      });
      if (!bridge.itemizedRows || bridge.itemizedRows.length===0){
        // If user has no rows yet, fake distribution based on expenses
        const ex = Number(bridge.expenses)||0;
        catMap.Housing       = ex*0.35;
        catMap.Utilities     = ex*0.12;
        catMap.Food          = ex*0.20;
        catMap.Health        = ex*0.07;
        catMap.Entertainment = ex*0.07;
        catMap.Other         = ex*0.19;
      }
      return bucketOrder.map(k=>Math.round(catMap[k]||0));
    }
    /* ---------- Rent vs Buy mock curve ---------- */
    function buildRentVsBuySeries(){
      // Simple predictable fake curve (10 yrs)
      const labels = Array.from({length:11},(_,i)=>"Year "+i);
      const buySeries  = [];
      const rentSeries = [];
      let baseBuy=0;
      let baseRent=0;
      for(let i=0;i<labels.length;i++){
        baseBuy  += 10000 + rnd(0,4000);
        baseRent += 11000 + rnd(0,4000);
        buySeries.push(baseBuy);
        rentSeries.push(baseRent);
      }
      // Approx break-even (if ever cheaper to buy)
      let beIndex = null;
      for(let i=0;i<labels.length;i++){
        if(buySeries[i] <= rentSeries[i]){ beIndex=i; break; }
      }
      const beYears = beIndex===null ? null : beIndex;
      return {labels,buySeries,rentSeries,beYears};
    }
    /* ---------- Render everything ---------- */
    function paintAll(){
      const inc   = Number(bridge.income)||0;
      const exp   = Number(bridge.expenses)||0;
      const sav   = Number(bridge.savings)||0;
      const house = Number(bridge.housing)||Math.round((bridge.price||300000)*0.0065);
      const disp  = inc - exp - sav - house;
      const score = Number(bridge.creditScore)||720;
      // KPIs
      $("#k-income").textContent  = cur0(inc);
      $("#k-expense").textContent = cur0(exp);
      $("#k-mtg").textContent     = cur0(house);
      $("#k-save").textContent    = cur0(sav);
      $("#fid-disp").textContent  = cur0(disp);
      $("#k-score").textContent   = score;
      // Credit band text + marker
      let band = "Good";
      if(score>=760) band="Excellent";
      else if(score>=720) band="Good";
      else if(score>=680) band="Fair";
      else if(score>=640) band="OK-ish";
      else if(score>=620) band="Weak";
      else band="Subprime";
      $("#score-band").textContent = "("+band+")";
      const pct = Math.max(0, Math.min(1,(score-300)/(850-300)));
      $("#score-marker").style.left = (pct*100)+"%";
      // Grade chip + meter
      const g = computeGrade({
        income:inc, expenses:exp, savings:sav, housing:house
      });
      $("#fid-grade").textContent = g.letter+" / Disposable";
      $("#fid-meter").style.width = (Math.max(0,Math.min(1,g.totalShare))*100)+"%";
      $("#fid-dot").style.background =
        (g.letter[0]==="A"||g.letter[0]==="B")
          ? "var(--ok)"
          : (g.letter[0]==="C"
              ? "var(--warn)"
              : "var(--bad)");
      // PIE
      pieChart.data.datasets[0].data = [
        exp,
        house,
        sav,
        Math.max(0, disp)
      ];
      $("#pie-center").textContent = inc>0 ? inc.toLocaleString("en-US") : "0";
      pieChart.update();
      // BAR
      const bucketVals = buildBucketsFromBridge();
      barChart.data.labels = bucketOrder;
      barChart.data.datasets = [{
        label:"This Month",
        data: bucketVals,
        backgroundColor:[
          "#6aa7ff","#8ab6ff","#55d399",
          "#8ef3c5","#f9c74f","#b58cff"
        ],
        borderWidth:0,
        borderRadius:6
      }];
      barChart.update();
      // RENT VS BUY
      const rvb = buildRentVsBuySeries();
      lineChart.data.labels = rvb.labels;
      lineChart.data.datasets[0].data = rvb.buySeries;
      lineChart.data.datasets[1].data = rvb.rentSeries;
      lineChart.update();
      // rent selector
      const rentSel = $("#rent-select");
      const baseRentGuess = Math.max(1200, Math.round((bridge.price||320000)*0.01));
      const rentOptions = [];
      for(let d=-4; d<=4; d++){
        rentOptions.push(baseRentGuess + d*250);
      }
      rentSel.innerHTML = rentOptions.map(v=>(
        "<option value='"+v+"'>$"+v.toLocaleString("en-US")+"</option>"
      )).join("");
      rentSel.value = String(baseRentGuess);
      // break-even yrs
      const be = rvb.beYears;
      $("#be-yrs").textContent = (be==null) ? "—"
        : ((Math.round(be*10)/10).toFixed(1)+" yrs").replace(".0 yrs"," yrs");
    }
    /* ---------- Export button ---------- */
    $("#fid-export").addEventListener("click", ()=>{
      const el = document.getElementById("fid-card");
      const rect = el.getBoundingClientRect();
      const scale = Math.max(2, window.devicePixelRatio || 2);
      const cloned = el.cloneNode(true);
      const serializer = new XMLSerializer();
      const markup = serializer.serializeToString(cloned);
      const svg = '<svg xmlns="http://www.w3.org/2000/svg" width="'+(rect.width*scale)+'" height="'+(rect.height*scale)+'">' +
                    '<foreignObject x="0" y="0" width="100%" height="100%">' +
                      markup +
                    '</foreignObject>' +
                  '</svg>';
      const blob = new Blob([svg], {type:'image/svg+xml;charset=utf-8'});
      const url = URL.createObjectURL(blob);
      const img = new Image();
      img.onload = ()=>{
        const canvas = document.createElement('canvas');
        canvas.width = rect.width*scale;
        canvas.height = rect.height*scale;
        const ctx = canvas.getContext('2d');
        ctx.fillStyle = '#0f1220';
        ctx.fillRect(0,0,canvas.width,canvas.height);
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
        URL.revokeObjectURL(url);
        const a = document.createElement('a');
        a.download = 'Fiduciary-Snapshot.png';
        a.href = canvas.toDataURL('image/png');
        a.click();
      };
      img.src = url;
    });
    /* ---------- Mode toggles (future-ready) ---------- */
    document.getElementById("mode-abs").addEventListener("click", ()=>{
      document.getElementById("mode-abs").setAttribute("aria-pressed","true");
      document.getElementById("mode-pct").setAttribute("aria-pressed","false");
      // right now chart stays absolute; future: recalc % mode
    });
    document.getElementById("mode-pct").addEventListener("click", ()=>{
      document.getElementById("mode-pct").setAttribute("aria-pressed","true");
      document.getElementById("mode-abs").setAttribute("aria-pressed","false");
      // future: swap barChart.data to percentages
    });
    /* ---------- Boot ---------- */
    initCharts();
    paintAll();
  });
  </script>
      </section>
    </div>
  </section>
  <section>
    <div class="w-embed w-script"><!--  Fiduciary Memo — v1.4 (Rank + Last Name guaranteed)  -->
      <div id="fid-memo" data-summarize="https://theorozcorealty.netlify.app/.netlify/functions/summarize" style="all: initial;">
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
        <style>
    #fid-memo, #fid-memo *{ box-sizing:border-box; font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    :root{ --ink:#1b1f2b; --muted:#4b5568; --brand:#0f1220; --border:rgba(0,0,0,.10); }
    /* Card */
    #fid-memo .memo-card{
      background:#ffffff; color:var(--ink);
      border:1px solid var(--border); border-radius:14px;
      padding:0; margin:18px auto; width:100%; max-width:900px;
      box-shadow:0 10px 24px rgba(0,0,0,.25);
    }
    #fid-memo .memo-page{ padding:28px 28px 22px; }
    #fid-memo .memo-head{ text-align:center; margin-bottom:8px; }
    #fid-memo .memo-head img{ height:64px; width:auto; display:block; margin:6px auto 10px auto; }
    #fid-memo .memo-title{ font-weight:900; letter-spacing:.2px; font-size:18px; text-transform:uppercase; }
    #fid-memo .memo-sub{ color:var(--muted); font-size:12px; }
    #fid-memo .memo-hr{ border:none; border-top:1px solid var(--border); margin:12px 0 14px; }
    #fid-memo .memo-body p{ margin:10px 0; line-height:1.65; font-size:14px; }
    #fid-memo .memo-body strong{ font-weight:800; }
    #fid-memo .memo-meta{ display:flex; justify-content:space-between; gap:8px; color:var(--muted); font-size:12px; margin-bottom:2px; }
    #fid-memo .memo-sign{ margin-top:14px; border-top:1px dashed rgba(0,0,0,.18); padding-top:10px; font-size:13px; }
    /* Status note */
    #fid-memo .ai-note{ margin:10px 28px 18px; font-size:11px; }
    #fid-memo .ai-note.loading{ color:#334155; }
    #fid-memo .ai-note.success{ color:#177245; }
    #fid-memo .ai-note.error{ color:#b42318; }
    /* Toolbar */
    #fid-memo .toolbar{
      max-width:900px; margin:0 auto 10px; display:flex; gap:8px; justify-content:flex-end;
      font-size:13px;
    }
    #fid-memo .btn{
      padding:8px 12px; border-radius:10px; border:1px solid rgba(0,0,0,.12); background:#f8fafc; color:#0f172a; cursor:pointer;
    }
    #fid-memo .btn:hover{ filter:brightness(0.98); }
    @media print{
      #fid-memo .memo-card{ box-shadow:none; border-color:#bbb; }
      body, html{ background:#fff !important; }
      #fid-memo .toolbar{ display:none; }
    }
  </style>
        <div class="toolbar">
          <button id="memo-refresh" class="btn">Regenerate Memo</button>
          <button id="memo-print" class="btn">Print / Save PDF</button>
        </div>
        <div class="memo-card" id="memo">
          <div class="memo-page">
            <div class="memo-head">
              <img src="../images/Call-to-Action.png" alt="Orozco Crest">
              <div class="memo-title">FIDUCIARY MEMO</div>
              <div class="memo-sub">Board-Ready Summary</div>
            </div>
            <div class="memo-meta">
              <span id="memo-date"></span>
              <span id="memo-client">Client:</span>
              <span>Prepared by: The Orozco Realty</span>
            </div>
            <hr class="memo-hr">
            <div id="memo-body" class="memo-body">
              <p><em>Generating executive memo…</em></p>
            </div>
            <div class="memo-sign">— <strong>Elena</strong>, Your Virtual Concierge<br><span style="opacity:.85">The Orozco Realty</span></div>
          </div>
          <div id="memo-note" class="ai-note loading">Preparing AI memo…</div>
        </div>
        <script>
  (()=> {
    if (window.__FIDUCIARY_MEMO_MOUNTED__) return;
    window.__FIDUCIARY_MEMO_MOUNTED__ = true;
    /* ---------- small utils ---------- */
    const $=(q)=>document.querySelector(q);
    const cur=(n,d=0)=> (Number(n)||0).toLocaleString('en-US',{style:'currency',currency:'USD',minimumFractionDigits:d,maximumFractionDigits:d});
    function pmti(P,r,n){ if(r===0) return P/n; const x=Math.pow(1+r,n); return P*(r*x)/(x-1); }
    function scoreAPR(s){ s=Number(s)||720;
      if(s>=780) return 6.50; if(s>=760) return 6.75; if(s>=720) return 7.00; if(s>=700) return 7.20;
      if(s>=680) return 7.35; if(s>=660) return 7.85; if(s>=640) return 8.25; if(s>=620) return 9.25; return 9.95;
    }
    function gradeLocal(s){
      let g=92;
      if(s.totalShare>=0.85) g-=30; else if(s.totalShare>=0.70) g-=15; else g+=4;
      if(s.housingShare>0.40) g-=18; else if(s.housingShare>0.33) g-=8; else g+=4;
      if(s.freePost<0) g-=30; else if((s.freePost/s.income)<0.10) g-=10; else if((s.freePost/s.income)>=0.20) g+=4;
      const sr=s.savings/(s.income||1); if(sr<0.10) g-=8; else if(sr>=0.20) g+=4;
      g=Math.max(0,Math.min(100,g));
      const letter = g>=98?'A+': g>=92?'A': g>=88?'A-'
                   : g>=82?'B+': g>=76?'B': g>=72?'B-'
                   : g>=66?'C+': g>=60?'C': g>=55?'C-'
                   : g>=50?'D+': g>=45?'D':'F';
      return {g,letter};
    }
    const lastNameOf=(full)=> String(full||'').trim().split(/\s+/).slice(-1)[0]||'Client';
    /* ---------- identity helpers ---------- */
    function getStoredJSON(key){
      try{ const raw = localStorage.getItem(key); return raw? JSON.parse(raw): null; }catch(_){ return null; }
    }
    function extractIdentity(b){
      // Preferred: identity explicitly sent via bridge (see dashboard addition below)
      const bi = b?.identity || {};
      const profFromBridge = b?.profile || {};
      const profFromLocal  = getStoredJSON('realtysass.profile') || {};
      // Compose a name if we only have lastName
      const first = bi.firstName || profFromLocal.firstName || '';
      const last  = bi.lastName  || profFromLocal.lastName  || lastNameOf(profFromLocal.name||'');
      const name  = [first,last].filter(Boolean).join(' ') || profFromLocal.name || 'Client';
      return {
        name,
        email: bi.email || profFromLocal.email || '',
        branch: bi.branch || profFromLocal.branch || '',
        paygrade: bi.paygrade || '',
        rankTitle: bi.rankTitle || '',  // e.g., "Major"
        mode: bi.mode || ''             // AD or VET (optional)
      };
    }
    /* ---------- friendly fallbacks if only paygrade is available ---------- */
    function rankFromPaygrade(pg){
      const MAP = {"O-1":"Second Lieutenant","O-2":"First Lieutenant","O-3":"Captain","O-4":"Major","O-5":"Lieutenant Colonel","O-6":"Colonel",
                   "O-7":"Brigadier General","O-8":"Major General","O-9":"Lieutenant General","O-10":"General",
                   "W-1":"Warrant Officer 1","W-2":"Chief Warrant Officer 2","W-3":"Chief Warrant Officer 3","W-4":"Chief Warrant Officer 4","W-5":"Chief Warrant Officer 5",
                   "E-1":"Airman Basic / Private","E-2":"Airman / Private","E-3":"A1C / PFC","E-4":"Senior Airman / Specialist","E-5":"Staff Sergeant / Sergeant","E-6":"Technical Sergeant / Staff Sergeant",
                   "E-7":"Master Sergeant / SFC","E-8":"Senior Master Sergeant / 1st Sgt","E-9":"Chief Master Sergeant / Sgt Major"};
      const p = String(pg||'').toUpperCase().replace(/\s+/g,'');
      return MAP[p] || '';
    }
    /* ---------- bridge ---------- */
    const getSummarizeURL=()=> (document.getElementById('fid-memo')?.dataset?.summarize||'').trim();
    let bridge = null;
    try { const raw = localStorage.getItem('realtysass.bridge'); if (raw) bridge = JSON.parse(raw); } catch(e){}
    if (!bridge && location.hash){
      const m = location.hash.match(/(?:^|#|&)rsb=([A-Za-z0-9\-_]+)/);
      if (m){ try{ const json = decodeURIComponent(escape(atob(m[1].replace(/-/g,'+').replace(/_/g,'/')))); bridge = JSON.parse(json);}catch(e){} }
    }
    window.addEventListener('message', (ev)=>{
      try{ const msg = ev.data || {}; if (msg.type==='realtysass-bridge' && msg.payload){ bridge=msg.payload; paint(); } }catch(e){}
    }, false);
    /* ---------- snapshot ---------- */
    function pmSnapshot(b){
      const income   = Number(b?.income)||0;
      const expenses = Number(b?.expenses)||0;
      const savings  = Number(b?.savings)||0;
      let housing    = Number(b?.housing)||0;
      let pAndI      = Number(b?.pAndI)||0;
      const price = Number(b?.price)||0;
      const dpPct = Number(b?.dpPct)||0;
      const dpAmt = Number(b?.dpAmt) || (price * (dpPct/100));
      const apr   = Number(b?.apr)|| scoreAPR(Number(b?.creditScore)||720);
      const termY = Number(b?.termYears)||30;
      const tihoa = Number(b?.tihoa)||0;
      const pmi   = Number(b?.pmi)||0;
      if (!housing){
        const loan  = Math.max(0, price - dpAmt);
        const mRate = (apr/100)/12;
        const termN = Math.max(1, termY*12);
        pAndI = loan>0 ? pmti(loan, mRate, termN) : 0;
        housing = pAndI + tihoa + pmi;
      }
      const freePost = income - expenses - savings - housing;
      return {
        income, expenses, savings, housing, freePost,
        price, dpPct, dpAmt, apr, creditScore:Number(b?.creditScore)||720, termYears:termY,
        tihoa, pmi, pAndI,
        totalShare: income>0 ? (expenses+savings+housing)/income : 1,
        housingShare: income>0 ? housing/income : 1,
        dti: income>0 ? ((expenses+housing)/income) : 1,
        coverage: expenses>0 ? income/expenses : (income>0?Infinity:0),
        runwayMonths: expenses>0 ? (savings/expenses) : 0,
        profile: b?.profile || {},
        military: b?.military || {}
      };
    }
    function bucketsFromBridge(){
      try{
        const rows = Array.isArray(bridge?.itemizedRows) ? bridge.itemizedRows : JSON.parse(localStorage.getItem('va.expenses.rows')||'[]');
        if (!rows?.length) return {};
        const sums = {};
        rows.forEach(r=>{
          const k = String(r.cat||'Other');
          const v = Number(r.amount||r.monthly||r.month||0) || 0;
          sums[k] = (sums[k]||0) + v;
        });
        return sums;
      }catch(_){ return {}; }
    }
    /* ---------- local synthesis ---------- */
    function synthesizeFiveFromSnapshot(s, who){
      const last = who.name ? (who.name.trim().split(/\s+/).slice(-1)[0]) : 'Client';
      const rankNice = who.rankTitle || rankFromPaygrade(who.paygrade) || 'Service Member';
      const houPct = s.income>0 ? (s.housing/s.income)*100 : 0;
      const dtiPct = s.income>0 ? ((s.expenses+s.housing)/s.income)*100 : 0;
      const {letter} = gradeLocal(s);
      const cov = (s.coverage===Infinity)?'∞':(s.coverage||0).toFixed(2)+'×';
      const runway = (s.runwayMonths||0).toFixed(2);
      const laneMin = s.income*0.28, laneMax = s.income*0.33;
      const autoSave = Math.max(50, Math.round(s.income*0.10));
      const discShift = Math.round(s.income*0.10);
      const p1 = `<p><strong>${rankNice} ${last}</strong>, thank you for your service. This executive memo provides a precise, plain-English readout of your financial health, key risks, and the steps to correct them. With income <strong>${cur(s.income,0)}</strong>, expenses <strong>${cur(s.expenses,0)}</strong>, programmed savings <strong>${cur(s.savings,0)}</strong>, housing <strong>${cur(s.housing,0)}</strong> (~${houPct.toFixed(0)}%), DTI ~<strong>${dtiPct.toFixed(0)}%</strong>, coverage <strong>${cov}</strong>, and runway ~<strong>${runway} months</strong>, your current grade reads <strong>${letter}</strong>.</p>`;
      const p2 = `<p><strong>Financial Health—Concrete Targets.</strong> Keep housing in the <strong>28–33%</strong> lane: today that equals <strong>${cur(laneMin,0)}–${cur(laneMax,0)}</strong> per month all-in (P&I + taxes/insurance/HOA/PMI). Disposable income must stay positive; aim for <strong>≥10%</strong> of income left over. Set an automatic transfer of <strong>${cur(autoSave,0)}</strong> on payday to build a <strong>3–6 month</strong> reserve. If a mortgage quote pushes housing above ${cur(laneMax,0)} or DTI beyond <strong>43%</strong>, lower price or increase down payment before locking.</p>`;
      const p3 = `<p><strong>Biggest Issues Observed.</strong> The grade is most sensitive to high DTI and a thin runway. Credit score tiers directly move APR and payment; each tier can swing monthly cost by <strong>$75–$200+</strong>. If discretionary categories exceed <strong>10–12%</strong> of income, they suppress savings velocity and raise risk.</p>`;
      const p4 = `<p><strong>Improvement Playbook (Do This Next).</strong> 1) Pull free reports at <a href="https://www.annualcreditreport.com" target="_blank" rel="noopener">annualcreditreport.com</a>; dispute errors and drive utilization under <strong>30%</strong> (ideal <strong>&lt;10%</strong>). 2) Reallocate ~<strong>${cur(discShift,0)}</strong>/mo from discretionary to your autopay reserve until you reach <strong>3–6 months</strong>. 3) Keep total commitments ≤ <strong>70%</strong> of income; sequence debt by highest payment/lowest term (DTI relief). 4) When offering on a home, size to <strong>${cur(laneMin,0)}–${cur(laneMax,0)}</strong> all-in and negotiate seller credits; compare points vs lender credits. See <a href="https://www.consumerfinance.gov/" target="_blank" rel="noopener">cfpb.gov</a>.</p>`;
      const p5 = `<p><strong>Closing & Next Steps.</strong> We’ll convert these numbers into a pre-approval brief, then run property scenarios inside the housing lane, sequencing COE → underwriting → lock strategy → curated inventory. I will refresh this memo as your live numbers improve so you purchase with confidence.</p>`;
      return [p1,p2,p3,p4,p5].join('');
    }
    function enforceFive(html, fallbackHTML){
      const d=document.createElement('div'); d.innerHTML=html||'';
      let paras = Array.from(d.querySelectorAll('p')).map(p=>p.innerHTML.trim()).filter(Boolean);
      if (paras.length < 5 && fallbackHTML){
        const d2=document.createElement('div'); d2.innerHTML=fallbackHTML;
        paras = Array.from(d2.querySelectorAll('p')).map(p=>p.innerHTML.trim()).filter(Boolean);
      }
      while (paras.length < 5) paras.push('');
      if (paras.length > 5) paras = paras.slice(0,5);
      return paras.map(t=>`<p>${t}</p>`).join('');
    }
    async function fetchAIMemo(snapshot, totals, who){
      const url = getSummarizeURL();
      if (!url) return { error:'No summarize URL set' };
      const styleGuide = {
        persona: { name:"Elena, Virtual Concierge",
          role:"Executive Finance & Real Estate Strategist (CEO voice)",
          pedigree:"Harvard-trained, VA-loan specialist, boardroom communicator",
          voice:["Crisp, confident, data-forward","Plain English with banker precision","No slang, no emojis, no fluff"],
          audience: who.name || "Client"
        },
        purpose: "Five-paragraph CEO-grade memo: purpose, dollar targets, issues, playbook with links, closing.",
        structure: [
          "P1 – Rank + Last Name greeting; purpose and headline figures.",
          "P2 – Concrete targets: housing 28–33% lane in dollars; DI ≥10%; autopay reserve $ and 3–6 mo; DTI guardrails.",
          "P3 – Biggest issues tied to live numbers (credit tier $ impact; runway; discretionary %).",
          "P4 – Improvement playbook with links (utilization ladder; dispute flow; debt sequence; seller credits/points).",
          "P5 – Closing + next steps."
        ],
        formatting: { paragraphs:5, bullets:"none", boldKeyNumbers:true, currency:"USD, whole dollars", readingLevel:"executive" }
      };
      try{
        const res = await fetch(url, { method:'POST', headers:{ 'Content-Type':'application/json' },
          body: JSON.stringify({ kind:'fiduciary-memo', snapshot, buckets: totals, identity: who, styleGuide }) });
        if(!res.ok) throw new Error('HTTP '+res.status);
        return await res.json();
      }catch(e){ return { error:String(e.message||e) }; }
    }
    function setNote(state, text){
      const note=$('#memo-note');
      note.classList.remove('loading','error','success');
      note.classList.add(state);
      note.textContent = text;
    }
    function paint(){
      const s = pmSnapshot(bridge || {});
      const who = extractIdentity(bridge || {});
      const displayName = who.rankTitle
        ? `${who.rankTitle} ${ (who.name||'').trim().split(/\s+/).slice(-1)[0] || 'Client' }`
        : (who.name || 'Client');
      $('#memo-client').textContent = `Client: ${displayName}${who.email? ' • '+who.email : ''}`;
      try{ $('#memo-date').textContent = new Date().toLocaleDateString(undefined,{year:'numeric',month:'long',day:'numeric'});}catch(_){}
      const totals = bucketsFromBridge();
      const localFive = synthesizeFiveFromSnapshot(s, who);
      $('#memo-body').innerHTML = localFive;
      setNote('loading','Preparing AI memo…');
      (async ()=>{
        const ai = await fetchAIMemo(s, totals, who);
        if (ai?.memoHtml){
          const html = enforceFive(ai.memoHtml, localFive);
          $('#memo-body').innerHTML = html;
          setNote('success','AI memo generated via Netlify (OpenAI).');
        } else if (ai?.memo){
          const html = enforceFive(`<p>${String(ai.memo)}</p>`, localFive);
          $('#memo-body').innerHTML = html;
          setNote('success','AI memo generated via Netlify (OpenAI).');
        } else {
          $('#memo-body').innerHTML = localFive;
          setNote('error', `AI memo failed (${ai?.error||'unknown reason'}). Showing local executive analysis.`);
        }
      })();
    }
    $('#memo-refresh').addEventListener('click', paint);
    $('#memo-print').addEventListener('click', ()=> window.print());
    paint();
  })();
  </script>
      </div>
    </div>
  </section>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=68cecb820ec3dbdca3ef9099" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="../js/webflow.js" type="text/javascript"></script>
</body>
</html>